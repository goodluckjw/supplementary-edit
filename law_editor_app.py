(전체 수정된 코드 내용은 여기 들어감)